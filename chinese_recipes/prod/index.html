<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Results of Football matches England</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Oswald:200,300,400" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700,700i,900,900i&amp;subset=cyrillic" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Alice" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dosis:700,800" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <style>.cssload-container {
  width: 100%;
  height: 49px;
  text-align: center;
}
.cssload-speeding-wheel {
  width: 49px;
  height: 49px;
  margin: 0 auto;
  border: 3px solid #fff;
  border-radius: 50%;
  border-left-color: transparent;
  border-right-color: transparent;
  animation: cssload-spin 1325ms infinite linear;
  -o-animation: cssload-spin 1325ms infinite linear;
  -ms-animation: cssload-spin 1325ms infinite linear;
  -webkit-animation: cssload-spin 1325ms infinite linear;
  -moz-animation: cssload-spin 1325ms infinite linear;
}
@keyframes cssload-spin {
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@-webkit-keyframes cssload-spin {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
html,
body {
  margin: 0;
  padding: 0;
  width: 480px;
  height: 360px;
}
div {
  box-sizing: border-box;
}
a {
  text-decoration: none;
  color: inherit;
}
.placeholder {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: 'Alice', serif;
  color: #000;
  box-sizing: border-box;
  background: #fff;
  border: 1px solid grey;
}
.content {
  position: relative;
  width: 100%;
  z-index: 999;
  height: 100%;
}
.content__block {
  position: absolute;
  top: 0;
  left: 0;
  opacity: 1;
  z-index: 0;
  padding: 0 15px;
  height: 100%;
  width: 100%;
  background: rgba(249, 249, 249, 0.81);
  font-size: 20px;
  background-image: url('//www.bbcgoodfood.com/sites/default/files/styles/recipe/public/recipe_images/spicy-sichuan-style-prawns.jpg?itok=N_YDLuAX');
  background-position: center;
  background-size: 100% auto;
  color: #fff;
}
.content__block:before {
  content: "";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100px;
  background: linear-gradient(to bottom, rgba(0, 0, 0, 0.8), rgba(255, 255, 255, 0));
  z-index: 1;
}
.content__block:after {
  content: "";
  display: block;
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 260px;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.8), rgba(255, 255, 255, 0));
  z-index: 1;
}
.content__block__title {
  font-size: 40px;
  line-height: 39px;
  font-weight: bold;
  text-align: center;
  padding: 15px 25px;
  position: relative;
  z-index: 2;
}
.content__block__details {
  position: absolute;
  font-size: 0;
  text-align: center;
  z-index: 2;
  bottom: 50px;
  opacity: 0;
  transition: All 1s ease;
}
.content__block__details.show {
  bottom: 100px;
  opacity: 1;
}
.content__block__details.show.hide {
  bottom: 150px;
  opacity: 0;
}
.content__block__details__col {
  display: inline-block;
  vertical-align: middle;
  width: 50%;
  font-size: 30px;
}
.content__block__details__val {
  display: inline-block;
  vertical-align: middle;
}
.content__block__details__text {
  text-align: left;
}
.content__block__details_time {
  width: 100%;
  margin-bottom: 15px;
}
.content__block__details__img {
  border-radius: 50%;
  background-repeat: no-repeat;
  background-position: center;
  background-color: #6DAEB1;
  width: 40px;
  height: 40px;
  background-size: 30px;
  display: inline-block;
  vertical-align: middle;
  margin-right: 10px;
}
.content__block__details_time .content__block__details__img {
  background-image: url('http://widgets/chinese_recipes/prod/server/images/time_white.svg');
}
.content__block__details_skill .content__block__details__img {
  background-image: url('http://widgets/chinese_recipes/prod/server/images/cook_white.svg');
}
.content__block__details_serves .content__block__details__img {
  background-image: url('http://widgets/chinese_recipes/prod/server/images/serves_white.svg');
}
.content__block__nutrition {
  position: absolute;
  bottom: 0px;
  opacity: 0;
  width: 320px;
  margin: 0 auto;
  left: 50%;
  margin-left: -160px;
  font-size: 0;
  z-index: 2;
  border-bottom: 1px solid #fff;
  border-top: 1px solid #fff;
  border-left: 1px solid #fff;
  border-radius: 7px;
  background: rgba(0, 0, 0, 0.3);
  transition: All 1s ease;
}
.content__block__nutrition.show {
  opacity: 1;
  bottom: 50px;
}
.content__block__nutrition.show.hide {
  bottom: 100px;
  opacity: 0;
}
.content__block__nutrition__col {
  display: inline-block;
  vertical-align: top;
  width: 50%;
  font-size: 25px;
  text-align: center;
  border-right: 1px solid #fff;
}
.content__block__nutrition__col:nth-child(1) {
  border-bottom: 1px solid #fff;
}
.content__block__nutrition__col:nth-child(2) {
  border-radius: 0 7px 0 0;
  border-bottom: 1px solid #fff;
}
.content__block__nutrition__col:nth-child(4) {
  border-radius: 0 0 7px 0;
}
.content__block__nutrition__name {
  position: relative;
  padding: 10px 0;
  font-weight: 600;
}
.content__block__nutrition__name:after {
  content: "";
  display: block;
  position: absolute;
  width: 20px;
  height: 3px;
  background: #fff;
  left: 50%;
  margin-left: -10px;
  bottom: 0;
  border-radius: 3px;
}
.content__block__nutrition__val {
  padding-bottom: 10px;
}
.content__block__ingridiets {
  position: absolute;
  bottom: 30px;
  z-index: 2;
  opacity: 1;
  width: 400px;
  left: 50%;
  margin-left: -200px;
}
.content__block__ingridiets ul {
  text-align: center;
  list-style: none;
  font-size: 22px;
  margin: 0;
  transition: All 1s ease;
  opacity: 0;
  position: absolute;
  left: 0;
  bottom: 0;
}
.content__block__ingridiets ul.active {
  opacity: 1;
}
.content__block__ingridiets ul li {
  padding: 3px 0;
}
/* весь контейнер поддерживает перспективу */
.flip-container {
  -webkit-perspective: 1000;
          perspective: 1000;
}
/* переверните сторону при проведении мышью */
.flip-container.flip .flipper {
  -webkit-transform: rotateY(180deg);
          transform: rotateY(180deg);
}
.flip-container,
.front,
.back {
  width: 480px;
  height: 360px;
}
/* здесь находится скорость перевертывания */
.flipper {
  transition: 1s;
  -webkit-transform-style: preserve-3d;
          transform-style: preserve-3d;
  position: relative;
}
/* скройте обратную сторону во время переворота */
.front,
.back {
  -webkit-backface-visibility: hidden;
          backface-visibility: hidden;
  position: absolute;
  top: 0;
  left: 0;
}
/* лицевая сторона размещена над обратной */
.front {
  z-index: 2;
}
/* обратная, изначально скрытая сторона */
.back {
  -webkit-transform: rotateY(180deg);
          transform: rotateY(180deg);
}
.preloader {
  position: absolute;
  top: 50%;
  margin-top: -25px;
  left: 50%;
  margin-left: -25px;
  width: auto;
  background: url('http://widgets/chinese_recipes/prod/server/images/ball.svg');
  width: 50px;
  height: 50px;
  background-size: 100%;
  -webkit-transform: rotate(0deg);
          transform: rotate(0deg);
  -webkit-animation: rotateBall  15s infinite linear;
          animation: rotateBall  15s infinite linear;
}
.preloader.slow {
  -webkit-animation-duration: 200s;
          animation-duration: 200s;
}
@-webkit-keyframes rotateBall {
  to {
    -webkit-transform: rotate(3600deg);
            transform: rotate(3600deg);
  }
}
@keyframes rotateBall {
  to {
    -webkit-transform: rotate(3600deg);
            transform: rotate(3600deg);
  }
}
</style>
</head>
<body>
    <div class="placeholder flip-container">
        <div class="content flipper">
            <div class="content__block front js-block-front" data-clone="true">
                <div class="content__block__title js-title">Spicy Sichuan-style prawns</div>
                <div class="content__block__details js-details">
                    <div class="content__block__details__col content__block__details_time">
                        <div class="content__block__details__img"></div>
                        <div class="content__block__details__val">
                            <div class="content__block__details__text js-cook">COOK</div>
                            <div class="content__block__details__text js-prep">PREP</div>
                        </div>
                    </div>
                    <div class="content__block__details__col content__block__details_skill">
                        <div class="content__block__details__img"></div>
                        <div class="content__block__details__val">
                            <div class="content__block__details__text js-skill">EASY</div>
                        </div>
                    </div>
                    <div class="content__block__details__col content__block__details_serves">
                        <div class="content__block__details__img"></div>
                        <div class="content__block__details__val">
                            <div class="content__block__details__text js-serves">SERVES 4</div>
                        </div>
                    </div>
                </div>
                <div class="content__block__nutrition js-nutrition">
                    <div class="content__block__nutrition__col">
                        <div class="content__block__nutrition__col__inner">
                            <div class="content__block__nutrition__name">kcal</div>
                            <div class="content__block__nutrition__val js-kcal">156</div>
                        </div>
                    </div>
                    <div class="content__block__nutrition__col">
                        <div class="content__block__nutrition__col__inner">
                            <div class="content__block__nutrition__name">salt</div>
                            <div class="content__block__nutrition__val js-salt">1.1g</div>
                        </div>
                    </div>
                    <div class="content__block__nutrition__col">
                        <div class="content__block__nutrition__col__inner">
                            <div class="content__block__nutrition__name">sugars</div>
                            <div class="content__block__nutrition__val js-sugars">1g</div>
                        </div>
                    </div>
                    <div class="content__block__nutrition__col">
                        <div class="content__block__nutrition__col__inner">
                            <div class="content__block__nutrition__name">protein</div>
                            <div class="content__block__nutrition__val js-protein">20g</div>
                        </div>
                    </div>
                </div>
                <div class="content__block__ingridiets js-ingridiets"></div>
            </div>
            <div class="content__block back js-block-back" data-clone="true">
                <div class="content__block__title js-title">Spicy Sichuan-style prawns</div>
                <div class="content__block__details js-details">
                    <div class="content__block__details__col content__block__details_time">
                        <div class="content__block__details__img"></div>
                        <div class="content__block__details__val">
                            <div class="content__block__details__text js-cook">COOK</div>
                            <div class="content__block__details__text js-prep">PREP</div>
                        </div>
                    </div>
                    <div class="content__block__details__col content__block__details_skill">
                        <div class="content__block__details__img"></div>
                        <div class="content__block__details__val">
                            <div class="content__block__details__text js-skill">EASY</div>
                        </div>
                    </div>
                    <div class="content__block__details__col content__block__details_serves">
                        <div class="content__block__details__img"></div>
                        <div class="content__block__details__val">
                            <div class="content__block__details__text js-serves">SERVES 4</div>
                        </div>
                    </div>
                </div>
                <div class="content__block__nutrition js-nutrition">
                    <div class="content__block__nutrition__col">
                        <div class="content__block__nutrition__col__inner">
                            <div class="content__block__nutrition__name">kcal</div>
                            <div class="content__block__nutrition__val js-kcal">156</div>
                        </div>
                    </div>
                    <div class="content__block__nutrition__col">
                        <div class="content__block__nutrition__col__inner">
                            <div class="content__block__nutrition__name">salt</div>
                            <div class="content__block__nutrition__val js-salt">1.1g</div>
                        </div>
                    </div>
                    <div class="content__block__nutrition__col">
                        <div class="content__block__nutrition__col__inner">
                            <div class="content__block__nutrition__name">sugars</div>
                            <div class="content__block__nutrition__val js-sugars">1g</div>
                        </div>
                    </div>
                    <div class="content__block__nutrition__col">
                        <div class="content__block__nutrition__col__inner">
                            <div class="content__block__nutrition__name">protein</div>
                            <div class="content__block__nutrition__val js-protein">20g</div>
                        </div>
                    </div>
                </div>
                <div class="content__block__ingridiets js-ingridiets"></div>
            </div>
        </div>
        <!--<div class="preloader"></div>-->
    </div>
<script>$(document).ready(function() {
    /* eslint no-console:0 */
    /* eslint eqeqeq: 0 */

    function createStructure(obj, side) {
        console.log('createStructure',side);
        var elem = side === 'front' ? $('.js-block-front[data-clone=true]') : $('.js-block-back[data-clone=true]');

        //clean
        elem.find('.js-ingridiets').html('');
        elem.find('.js-details').removeClass('show').removeClass('hide');
        elem.find('.js-nutrition').removeClass('show').removeClass('hide');

        elem.find('.js-title').html(obj.name);

        elem.find('.js-cook').html(elem.find('.js-cook').html() + ' ' + obj.details.cook);
        elem.find('.js-prep').html(elem.find('.js-prep').html() + ' ' + obj.details.prep);
        elem.find('.js-skill').html(obj.details.skill);
        elem.find('.js-serves').html(obj.details.serves);

        elem.find('.js-kcal').html(obj.nutrition.kcal);
        elem.find('.js-salt').html(obj.nutrition.salt);
        elem.find('.js-sugars').html(obj.nutrition.sugars);
        elem.find('.js-protein').html(obj.nutrition.protein);

        var subArr = [];
        var it = 0;
        subArr[it] = [];

        for (var i = 0; obj.ingridiets.length > i; i++) {
            if (i % 5 == 0) {
                it++;
                subArr[it] = [];
                subArr[it].push(obj.ingridiets[i]);
            } else {
                subArr[it].push(obj.ingridiets[i]);
            }
        }

        subArr.splice(0, 1)
        //console.log(subArr);

        for (var i = 0; subArr.length> i;i++) {
            var ul = '<ul class="ul_'+ i +' animated"></ul>';
            elem.find('.js-ingridiets').append(ul);

            for (var it = 0; subArr[i].length> it;it++) {
                elem.find('.ul_' + i).append('<li>' + subArr[i][it] + '</li>');
            }
        }

    }


    function animate(side) {
        time = new Date();
        startTime = time.getTime();
        //console.log('animate', side);
        var block = $('.js-block-' + side);
        console.log(block);
        setTimeout(function() {
            block.find('.js-details').addClass('show');
            console.log('js-details add show')
        }, 500)

        setTimeout(function() {
            block.find('.js-details').addClass('hide');
            console.log('js-details add hide')
        }, 5500)

        setTimeout(function() {
            block.find('.js-nutrition').addClass('show');
            console.log('js-nutrition add hide')
        }, 5550)

        setTimeout(function() {
            block.find('.js-nutrition').addClass('hide');
            console.log('js-nutrition add hide');
            $('.placeholder').trigger('animateFinished', [side]);
        }, 10550)


        var i = 0;
        /*var timerId = setTimeout(function tick() {

            if (i < block.find('.js-ingridiets ul').length) {

                block.find('.js-ingridiets ul').eq(i).addClass('active');

                setTimeout(function() {
                    block.find('.js-ingridiets ul.active').addClass('shake').removeClass('active');
                    console.log(123);
                    i++;
                }, 3000)
                //i++;
            } else {
                i =0;
                time = new Date();
                console.log((time.getTime() - startTime) / 1000);
                $('.placeholder').trigger('animateFinished', [side]);
            }
            timerId = setTimeout(tick, 3000);
        }, 11000);*/
    }

    try {
        var time
          , startTime
          ;

        $.ajax({
            url: 'http://widgets/chinese_recipes/prod/server/recipes.json',
            beforeSend: function(){
                time = new Date();
                startTime = time.getTime();
            },
            success: function(d) {
                time = new Date();
                console.log((time.getTime() - startTime) / 1000);

                try {
                    //console.log('football data - ', JSON.parse(d));
                    console.log('football data - ', d);

                    //d = JSON.parse(d);
                    createStructure(d[0], 'front');
                    createStructure(d[1], 'back');

                    var deg = 0;

                    setTimeout(function(){
                        animate('front');
                    }, 1000)
                    var itm = 2;

                    $('.placeholder').on('animateFinished', function(e, side) {
                        console.log(side);

                        var sideNew = side === 'front' ? 'back' : 'front';

                        deg = deg + 180;
                        $('.flipper').css('transform', 'rotateY('+ deg +'deg)');
                        createStructure(d[itm], side);
                        animate(sideNew);

                    });

                    /*setInterval(function() {
                        deg = deg + 180;
                        $('.flipper').css('transform', 'rotateY('+ deg +'deg)');
                        console.log(deg);

                    }, 2000)*/



                } catch (e) {
                    console.log(e);
                    console.log('ошибка внутри ajax');
                }

            },
            complete: function() {},
            error: function(jqXHR, textStatus, errorThrown) {
                console.log(jqXHR, textStatus, errorThrown);
                $('.preloader').addClass('error')
            }
        })
    } catch (e) {
        console.log(e);
        console.log('ошибка ajax');
        $('.preloader').addClass('error')
    }
})</script>
</body>
</html>