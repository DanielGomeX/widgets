<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Динамика курса</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Oswald:200,300,400" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700,700i,900,900i&amp;subset=cyrillic" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Alice" rel="stylesheet">
    <!-- Chartist.js -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
    <script src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
    <!--  -->
    <style>.cssload-container{width:100%;height:49px;text-align:center}.cssload-speeding-wheel{width:49px;height:49px;margin:0 auto;border:3px solid #fff;border-radius:50%;border-left-color:transparent;border-right-color:transparent;animation:cssload-spin 1325ms infinite linear;-o-animation:cssload-spin 1325ms infinite linear;-ms-animation:cssload-spin 1325ms infinite linear;-webkit-animation:cssload-spin 1325ms infinite linear;-moz-animation:cssload-spin 1325ms infinite linear}@keyframes cssload-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes cssload-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}body,html{margin:0;padding:0;width:480px;height:360px}div{box-sizing:border-box}a{text-decoration:none;color:inherit}.placeholder{position:relative;width:100%;height:100%;overflow:hidden;font-family:Oswald,sans-serif;color:#000;box-sizing:border-box;background:#fff;border:1px solid #d4d4d4}.header{font-size:35px;padding:0 50px}.header__title{display:inline-block;margin-right:15px}.header__mounth{text-transform:uppercase}.content{width:100%;height:100%}.content__chart{position:absolute;top:60px;height:300px}.content__description{opacity:0;position:absolute;top:15px;background:rgba(255,255,255,.9);z-index:7;height:250px;width:415px;left:50px;font-size:30px;padding:20px 75px}.content__description.active{opacity:1;transition:All 1s ease}.content__description__row{margin-bottom:15px}.content__description_max .content__description__value{color:green}.content__description_min .content__description__value{color:red}.content__description__title{display:inline-block;vertical-align:middle;width:190px}.content__description__value{display:inline-block;vertical-align:middle}.content__direction{position:absolute;bottom:30px;left:50px;min-width:60px;height:60px;opacity:0;padding-left:60px;font-size:25px;line-height:60px}.content__direction.show{opacity:1;transition:All 1s ease}.content__direction.up{color:#007f00;background:url(https://js.dooh.xyz/exchange_dynamics/server/images/rate_up.svg);background-size:60px;background-repeat:no-repeat}.content__direction.down{color:red;background:url(https://js.dooh.xyz/exchange_dynamics/server/images/rate_down.svg);background-size:60px;background-repeat:no-repeat}.ct-bar.ct-threshold-above,.ct-line.ct-threshold-above,.ct-point.ct-threshold-above{stroke:#59922b!important}.ct-bar.ct-threshold-below,.ct-line.ct-threshold-below,.ct-point.ct-threshold-below{stroke:#f05b4f!important}.ct-area.ct-threshold-above{fill:#59922b!important}.ct-area.ct-threshold-below{fill:#f05b4f!important}.ct-area.up{fill:#59922b}.ct-area.down{fill:#f05b4f}.ct-area,.ct-line{pointer-events:none}.ct-line{stroke-width:3px;stroke-dasharray:5px;-webkit-animation:dashoffset 1s linear infinite;animation:dashoffset 1s linear infinite}.ct-line.show{stroke-opacity:1;transition:All 1s ease}.ct-point{stroke-width:9px;stroke-linecap:round}@-webkit-keyframes dashoffset{to{stroke-dashoffset:10px}}@keyframes dashoffset{to{stroke-dashoffset:10px}}.cssload-container.preloader{position:absolute;top:50%;margin-top:-29px;left:50%;margin-left:-29px;width:auto}.cssload-container.preloader .cssload-speeding-wheel{border-left-color:#000;border-right-color:#000}.cssload-container.preloader.error .cssload-speeding-wheel{border-left-color:#fff;border-right-color:#fff;border-top-color:red;border-bottom-color:red}</style>
</head>
<body>
    <div class="placeholder">
        <div class="header">
            <span class="header__title">Курс <span class="header__currency-name">USD</span>      </span>
            <span class="header__mounth">Апрель</span>
            <span class="header__year">2017 г.</span>
        </div>
        <div class="content">
            <div class="ct-chart ct-perfect-fourth content__chart">
                <div class="content__description js-description">
                    <div class="content__description_max content__description__row">
                        <span class="content__description__title">Максимальный</span>
                        <span class="content__description__value js-descr-max">57.3896</span>
                    </div>
                    <div class="content__description_min content__description__row">
                        <span class="content__description__title">Минимальный</span>
                        <span class="content__description__value js-descr-min">57.3896</span>
                    </div>
                    <div class="content__description_average content__description__row">
                        <span class="content__description__title">Средний</span>
                        <span class="content__description__value js-descr-average">57.3896</span>
                    </div>
                </div>
                <div class="content__direction js-direction"></div>
            </div>

        </div>
        <div class="cssload-container preloader">
            <div class="cssload-speeding-wheel"></div>
        </div>
    </div>
<script>$(document).ready(function(){function e(e){for(var a=0,t=0;e.length>t;t++)a+=e[t];return a/e.length}try{var a,t;$.ajax({url:"https://js.dooh.xyz/exchange_dynamics/server/redirect.php",beforeSend:function(){a=new Date,t=a.getTime()},success:function(i){a=new Date,console.log((a.getTime()-t)/1e3);try{console.log("exchange_dynamics data - ",JSON.parse(i));var n=JSON.parse(i),o={};for(var s in n){o[s]={},o[s].labels=[],o[s].series=[];var r=[];for(var l in n[s])o[s].labels.push(l),r.push({meta:"descr",value:parseFloat(n[s][l].USD.replace(" RUB","").replace(",","."))}),o[s].series=new Array(r)}var d=[];for(var u in o)d.push(u);console.log("exchange_dynamics  NEW data - ",o);var m={width:480,height:300,fullWidth:!0,showArea:!0};$(".header__mounth").html(d[0]);var c=new Chartist.Line(".ct-chart",o[d[0]],m);c.eventEmitter.addEventHandler("finishDrowingLine",function(){});var p=0,h=[];c.on("created",function(){p=0}),c.on("draw",function(e){if(p++,"line"===e.type)e.element.animate({opacity:{begin:80*p+1e3,dur:500,from:0,to:1}}),setTimeout(function(){c.eventEmitter.emit("finishDrowingLine")},80*p+1e3);else if("label"===e.type&&"x"===e.axis)e.element.animate({y:{begin:80*p,dur:500,from:e.y+100,to:e.y,easing:"easeOutQuart"}});else if("area"===e.type)e.element.animate({opacity:{begin:80*p+1e3,dur:500,from:0,to:.6}});else if("label"===e.type&&"y"===e.axis)e.element.animate({x:{begin:80*p,dur:500,from:e.x-100,to:e.x,easing:"easeOutQuart"}});else if("point"===e.type)h.push(e.value.y),e.element.animate({x1:{begin:80*p,dur:500,from:e.x-10,to:e.x,easing:"easeOutQuart"},x2:{begin:80*p,dur:500,from:e.x-10,to:e.x,easing:"easeOutQuart"},opacity:{begin:80*p,dur:500,from:0,to:1,easing:"easeOutQuart"}});else if("grid"===e.type){var a={begin:80*p,dur:500,from:e[e.axis.units.pos+"1"]-30,to:e[e.axis.units.pos+"1"],easing:"easeOutQuart"},t={begin:80*p,dur:500,from:e[e.axis.units.pos+"2"]-100,to:e[e.axis.units.pos+"2"],easing:"easeOutQuart"},i={};i[e.axis.units.pos+"1"]=a,i[e.axis.units.pos+"2"]=t,i.opacity={begin:80*p,dur:500,from:0,to:1,easing:"easeOutQuart"},e.element.animate(i)}});var f=1;c.on("finishDrowingLine",function(){$(".js-direction").addClass("show"),setTimeout(function(){$(".js-description").addClass("active")},2e3)}),c.on("created",function(a){var t=a.axisX.ticks.length*a.axisY.ticks.length*80-3e3,i={};$(".js-direction").removeClass("down").removeClass("up").removeClass("show"),$(".ct-area").removeClass("down").removeClass("up"),h[0]>h[h.length-1]?(i.direction="down",i.diff=h[0]-h[h.length-1],$(".js-direction").addClass("down").html("- "+i.diff.toFixed(2)+" ₽"),$(".ct-area").addClass("down")):(i.direction="up",i.diff=h[h.length-1]-h[0],$(".js-direction").addClass("up").html("+ "+i.diff.toFixed(2)+" ₽"),$(".ct-area").addClass("up")),$(".js-descr-max").html(Math.max.apply(Math,h).toFixed(2)),$(".js-descr-min").html(Math.min.apply(Math,h).toFixed(2)),$(".js-descr-average").html(e(h).toFixed(2)),setTimeout(function(){$(".js-direction").removeClass("down").removeClass("up").removeClass("show"),h=[]},t+3e3),window.__exampleAnimateTimeout&&(clearTimeout(window.__exampleAnimateTimeout),window.__exampleAnimateTimeout=null),window.__exampleAnimateTimeout=setTimeout(function(){f<d.length?($(".header__mounth").html(d[f]),$(".js-description").removeClass("active"),c.update(o[d[f]]),f++):(f=0,$(".header__mounth").html(d[f]),$(".js-description").removeClass("active"),c.update(o[d[f]]))},18e3)}),$(".content__wrapper").show(),$(".js-block").eq(0).fadeIn(500).addClass("active"),$(".preloader").hide()}catch(e){console.log(e),console.log("ошибка внутри ajax")}},complete:function(){},error:function(e,a,t){console.log(e,a,t),$(".preloader").addClass("error")}})}catch(e){console.log(e),console.log("ошибка ajax"),$(".preloader").addClass("error")}});</script>
</body>
</html>