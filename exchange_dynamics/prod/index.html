<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Динамика курса</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Oswald:200,300,400" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700,700i,900,900i&amp;subset=cyrillic" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Alice" rel="stylesheet">
    <!-- Chartist.js -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
    <script src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
    <!-- <script type="text/javascript" src="prod/server/tooltip.min.js"></script> -->
    <!--  -->
    <style>.cssload-container{width:100%;height:49px;text-align:center}.cssload-speeding-wheel{width:49px;height:49px;margin:0 auto;border:3px solid #fff;border-radius:50%;border-left-color:transparent;border-right-color:transparent;animation:cssload-spin 1325ms infinite linear;-o-animation:cssload-spin 1325ms infinite linear;-ms-animation:cssload-spin 1325ms infinite linear;-webkit-animation:cssload-spin 1325ms infinite linear;-moz-animation:cssload-spin 1325ms infinite linear}@keyframes cssload-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes cssload-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}body,html{margin:0;padding:0;width:480px;height:360px}div{box-sizing:border-box}a{text-decoration:none;color:inherit}.placeholder{position:relative;width:100%;height:100%;overflow:hidden;font-family:Oswald,sans-serif;color:#000;box-sizing:border-box;background:#fff;border:1px solid #d4d4d4}.header{font-size:35px;padding:0 50px}.header__title{display:inline-block;margin-right:15px}.header__mounth{text-transform:uppercase}.content{width:100%;height:100%}.content__chart{position:absolute;top:60px;height:300px}.content__description{opacity:0;position:absolute;top:15px;background:rgba(255,255,255,.9);z-index:7;height:250px;width:415px;left:50px;font-size:30px;padding:20px 75px}.content__description.active{opacity:1;transition:All 1s ease}.content__description__row{margin-bottom:15px}.content__description_max .content__description__value{color:green}.content__description_min .content__description__value{color:red}.content__description__title{display:inline-block;vertical-align:middle;width:190px}.content__description__value{display:inline-block;vertical-align:middle}.chartist-tooltip{position:absolute;display:inline-block;opacity:0;min-width:5em;padding:.5em;background:#f4c63d;color:#453d3f;font-family:Oxygen,Helvetica,Arial,sans-serif;font-weight:700;text-align:center;pointer-events:none;z-index:1;transition:opacity .2s linear}.chartist-tooltip:before{content:"";position:absolute;top:100%;left:50%;width:0;height:0;margin-left:-15px;border:15px solid transparent;border-top-color:#f4c63d}.chartist-tooltip.tooltip-show{opacity:1}.ct-area,.ct-line{pointer-events:none}.ct-line{stroke-width:3px}.ct-point{stroke-width:9px;stroke-linecap:round;z-index:9}.ct-series-a .ct-line,.ct-series-a .ct-point{stroke:#85bb65}.ct-series-b .ct-line,.ct-series-b .ct-point{stroke:#00f}.cssload-container.preloader{position:absolute;top:50%;margin-top:-29px;left:50%;margin-left:-29px;width:auto}.cssload-container.preloader .cssload-speeding-wheel{border-left-color:#000;border-right-color:#000}.cssload-container.preloader.error .cssload-speeding-wheel{border-left-color:#fff;border-right-color:#fff;border-top-color:red;border-bottom-color:red}</style>
</head>
<body>
    <div class="placeholder">
        <div class="header">
            <span class="header__title">Курс <span class="header__currency-name">USD</span>      </span>
            <span class="header__mounth">Апрель</span>
            <span class="header__year">2017 г.</span>
        </div>
        <div class="content">
            <div class="ct-chart ct-perfect-fourth content__chart">
                <div class="content__description js-description">
                    <div class="content__description_max content__description__row">
                        <span class="content__description__title">Максимальный</span>
                        <span class="content__description__value js-descr-max">57.3896</span>
                    </div>
                    <div class="content__description_min content__description__row">
                        <span class="content__description__title">Минимальный</span>
                        <span class="content__description__value js-descr-min">57.3896</span>
                    </div>
                    <div class="content__description_average content__description__row">
                        <span class="content__description__title">Средний</span>
                        <span class="content__description__value js-descr-average">57.3896</span>
                    </div>
                </div>
            </div>

        </div>
        <div class="cssload-container preloader">
            <div class="cssload-speeding-wheel"></div>
        </div>
    </div>
<script>$(document).ready(function(){function e(e){for(var a=0,t=0;e.length>t;t++)a+=e[t];return a/e.length}try{var a,t;$.ajax({url:"https://js.dooh.xyz/exchange_dynamics/server/redirect.php",beforeSend:function(){a=new Date,t=a.getTime()},success:function(n){a=new Date,console.log((a.getTime()-t)/1e3);try{console.log("exchange_dynamics data - ",JSON.parse(n));var o=JSON.parse(n),i={};for(var r in o){i[r]={},i[r].labels=[],i[r].series=[];var s=[];for(var l in o[r])i[r].labels.push(l),s.push({meta:"descr",value:parseFloat(o[r][l].USD.replace(" RUB","").replace(",","."))}),i[r].series=new Array(s)}var u=[];for(var d in i)u.push(d);console.log(i);var m={width:480,height:300,fullWidth:!0};$(".header__mounth").html(u[0]);var c=new Chartist.Line(".ct-chart",i[u[0]],m),p=0;c.on("created",function(){p=0});var h=[];c.on("draw",function(e){if(p++,"point"==e.type&&(h[e.index]=e.value.y),"line"===e.type)e.element.animate({opacity:{begin:80*p+1e3,dur:500,from:0,to:1}});else if("label"===e.type&&"x"===e.axis)e.element.animate({y:{begin:80*p,dur:500,from:e.y+100,to:e.y,easing:"easeOutQuart"}});else if("label"===e.type&&"y"===e.axis)e.element.animate({x:{begin:80*p,dur:500,from:e.x-100,to:e.x,easing:"easeOutQuart"}});else if("point"===e.type)e.element.animate({x1:{begin:80*p,dur:500,from:e.x-10,to:e.x,easing:"easeOutQuart"},x2:{begin:80*p,dur:500,from:e.x-10,to:e.x,easing:"easeOutQuart"},opacity:{begin:80*p,dur:500,from:0,to:1,easing:"easeOutQuart"}});else if("grid"===e.type){var a={begin:80*p,dur:500,from:e[e.axis.units.pos+"1"]-30,to:e[e.axis.units.pos+"1"],easing:"easeOutQuart"},t={begin:80*p,dur:500,from:e[e.axis.units.pos+"2"]-100,to:e[e.axis.units.pos+"2"],easing:"easeOutQuart"},n={};n[e.axis.units.pos+"1"]=a,n[e.axis.units.pos+"2"]=t,n.opacity={begin:80*p,dur:500,from:0,to:1,easing:"easeOutQuart"},e.element.animate(n)}});var g=1;c.on("created",function(a){$(".js-descr-max").html(Math.max.apply(Math,h).toFixed(2)),$(".js-descr-min").html(Math.min.apply(Math,h).toFixed(2)),$(".js-descr-average").html(e(h).toFixed(2)),setTimeout(function(){$(".js-description").addClass("active")},12e3),window.__exampleAnimateTimeout&&(clearTimeout(window.__exampleAnimateTimeout),window.__exampleAnimateTimeout=null),window.__exampleAnimateTimeout=setTimeout(function(){g<u.length?($(".header__mounth").html(u[g]),$(".js-description").removeClass("active"),c.update(i[u[g]]),g++):(g=0,$(".header__mounth").html(u[g]),$(".js-description").removeClass("active"),c.update(i[u[g]]))},18e3)}),$(".content__wrapper").show(),$(".js-block").eq(0).fadeIn(500).addClass("active"),$(".preloader").hide()}catch(e){console.log(e),console.log("ошибка внутри ajax")}},complete:function(){},error:function(e,a,t){console.log(e,a,t),$(".preloader").addClass("error")}})}catch(e){console.log(e),console.log("ошибка ajax"),$(".preloader").addClass("error")}});</script>
</body>
</html>