$(document).ready(function(){function e(e){for(var a=0,t=0;e.length>t;t++)a+=e[t];return a/e.length}try{var a,t;$.ajax({url:"https://js.dooh.xyz/exchange_dynamics/server/redirect.php",beforeSend:function(){a=new Date,t=a.getTime()},success:function(i){a=new Date,console.log((a.getTime()-t)/1e3);try{console.log("exchange_dynamics data - ",JSON.parse(i));var n=JSON.parse(i),o={};for(var s in n){o[s]={},o[s].labels=[],o[s].series=[];var r=[];for(var l in n[s])o[s].labels.push(l),r.push({meta:"descr",value:parseFloat(n[s][l].USD.replace(" RUB","").replace(",","."))}),o[s].series=new Array(r)}var d=[];for(var u in o)d.push(u);d.reverse(),console.log("exchange_dynamics  NEW data - ",o);var c={width:480,height:300,fullWidth:!0,showArea:!0};$(".header__mounth").html(d[0]);var m=new Chartist.Line(".ct-chart",o[d[0]],c);m.eventEmitter.addEventHandler("finishDrowingLine",function(){});var p=0,h=[];m.on("created",function(){p=0}),m.on("draw",function(e){if(p++,"line"===e.type)e.element.animate({opacity:{begin:80*p+1e3,dur:500,from:0,to:1}}),setTimeout(function(){m.eventEmitter.emit("finishDrowingLine")},80*p+1e3);else if("label"===e.type&&"x"===e.axis)e.element.animate({y:{begin:80*p,dur:500,from:e.y+100,to:e.y,easing:"easeOutQuart"}});else if("area"===e.type)e.element.animate({opacity:{begin:80*p+1e3,dur:500,from:0,to:.6}});else if("label"===e.type&&"y"===e.axis)e.element.animate({x:{begin:80*p,dur:500,from:e.x-100,to:e.x,easing:"easeOutQuart"}});else if("point"===e.type)h.push(e.value.y),e.element.animate({x1:{begin:80*p,dur:500,from:e.x-10,to:e.x,easing:"easeOutQuart"},x2:{begin:80*p,dur:500,from:e.x-10,to:e.x,easing:"easeOutQuart"},opacity:{begin:80*p,dur:500,from:0,to:1,easing:"easeOutQuart"}});else if("grid"===e.type){var a={begin:80*p,dur:500,from:e[e.axis.units.pos+"1"]-30,to:e[e.axis.units.pos+"1"],easing:"easeOutQuart"},t={begin:80*p,dur:500,from:e[e.axis.units.pos+"2"]-100,to:e[e.axis.units.pos+"2"],easing:"easeOutQuart"},i={};i[e.axis.units.pos+"1"]=a,i[e.axis.units.pos+"2"]=t,i.opacity={begin:80*p,dur:500,from:0,to:1,easing:"easeOutQuart"},e.element.animate(i)}});var f=1;m.on("finishDrowingLine",function(){$(".js-direction").addClass("show")}),m.on("created",function(a){var t=a.axisX.ticks.length*a.axisY.ticks.length*80-3e3,i={};$(".js-direction").removeClass("down").removeClass("up"),$(".ct-area").removeClass("down").removeClass("up"),h[0]>h[h.length-1]?(i.direction="down",i.diff=h[0]-h[h.length-1],$(".js-direction").addClass("down").html("- "+i.diff.toFixed(2)+" ₽"),$(".ct-area").addClass("down")):(i.direction="up",i.diff=h[h.length-1]-h[0],$(".js-direction").addClass("up").html("+ "+i.diff.toFixed(2)+" ₽"),$(".ct-area").addClass("up")),$(".js-descr-max").html(Math.max.apply(Math,h).toFixed(2)),$(".js-descr-min").html(Math.min.apply(Math,h).toFixed(2)),$(".js-descr-average").html(e(h).toFixed(2)),setTimeout(function(){$(".js-description").addClass("active"),$(".js-direction").removeClass("down").removeClass("up").removeClass("show"),h=[]},t+3e3),window.__exampleAnimateTimeout&&(clearTimeout(window.__exampleAnimateTimeout),window.__exampleAnimateTimeout=null),window.__exampleAnimateTimeout=setTimeout(function(){f<d.length?($(".header__mounth").html(d[f]),$(".js-description").removeClass("active"),m.update(o[d[f]]),f++):(f=0,$(".header__mounth").html(d[f]),$(".js-description").removeClass("active"),m.update(o[d[f]]))},18e3)}),$(".content__wrapper").show(),$(".js-block").eq(0).fadeIn(500).addClass("active"),$(".preloader").hide()}catch(e){console.log(e),console.log("ошибка внутри ajax")}},complete:function(){},error:function(e,a,t){console.log(e,a,t),$(".preloader").addClass("error")}})}catch(e){console.log(e),console.log("ошибка ajax"),$(".preloader").addClass("error")}});